<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ - –ê—É–¥–∏—Ç–µ—Ä–∏—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #0F1014;
            color: #EAEAEA;
        }
        .test-section {
            background-color: #1A1B20;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        button {
            background-color: #FF9900;
            color: #0F1014;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #e68900;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success {
            background-color: #28a745;
            color: white;
        }
        .error {
            background-color: #dc3545;
            color: white;
        }
        .info {
            background-color: #17a2b8;
            color: white;
        }
        pre {
            background-color: #2A2B30;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h1>
    
    <div class="test-section">
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Catalog Service</h2>
        <button onclick="checkCatalogService()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–∏—Å</button>
        <div id="service-status" class="status info">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
        <pre id="service-result"></pre>
    </div>

    <div class="test-section">
        <h2>2. –¢–µ—Å—Ç API —Ç–æ–≤–∞—Ä–æ–≤</h2>
        <button onclick="testProductsAPI()">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
        <div id="products-status" class="status info">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
        <pre id="products-result"></pre>
    </div>

    <div class="test-section">
        <h2>3. –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞</h2>
        <button onclick="testCreateProduct()">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä</button>
        <div id="create-status" class="status info">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
        <pre id="create-result"></pre>
    </div>

    <div class="test-section">
        <h2>4. –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h2>
        <button onclick="window.open('admin/admin.html', '_blank')">–û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</button>
    </div>

    <div class="test-section">
        <h2>5. –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</h2>
        <button onclick="window.open('src/index.html', '_blank')">–û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8000';

        async function checkCatalogService() {
            try {
                showStatus('service-status', 'info', '–ü—Ä–æ–≤–µ—Ä–∫–∞ Catalog Service...');
                
                const response = await fetch(`${API_BASE_URL}/health`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                document.getElementById('service-result').textContent = JSON.stringify(data, null, 2);
                showStatus('service-status', 'success', 'Catalog Service —Ä–∞–±–æ—Ç–∞–µ—Ç!');
                
            } catch (error) {
                document.getElementById('service-result').textContent = error.toString();
                showStatus('service-status', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        async function testProductsAPI() {
            try {
                showStatus('products-status', 'info', '–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤...');
                
                const response = await fetch(`${API_BASE_URL}/api/v1/admin/products`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                document.getElementById('products-result').textContent = JSON.stringify(data, null, 2);
                showStatus('products-status', 'success', `–ü–æ–ª—É—á–µ–Ω–æ ${data.products.length} —Ç–æ–≤–∞—Ä–æ–≤`);
                
            } catch (error) {
                document.getElementById('products-result').textContent = error.toString();
                showStatus('products-status', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        async function testCreateProduct() {
            try {
                showStatus('create-status', 'info', '–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞...');
                
                const testProduct = {
                    name: "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä",
                    author_name: "–¢–µ—Å—Ç–æ–≤—ã–π –∞–≤—Ç–æ—Ä",
                    description: "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞",
                    price: 99.99,
                    cover_url: "https://example.com/test.jpg"
                };

                const response = await fetch(`${API_BASE_URL}/api/v1/admin/products`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testProduct)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                document.getElementById('create-result').textContent = JSON.stringify(data, null, 2);
                showStatus('create-status', 'success', '–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä —Å–æ–∑–¥–∞–Ω!');
                
            } catch (error) {
                document.getElementById('create-result').textContent = error.toString();
                showStatus('create-status', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        function showStatus(elementId, type, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            setTimeout(checkCatalogService, 1000);
        });
    </script>
</body>
</html>
