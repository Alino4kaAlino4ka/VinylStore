<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ - –ê—É–¥–∏—Ç–µ—Ä–∏—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #0F1014;
            color: #EAEAEA;
        }
        
        .test-container {
            background-color: #1A1B20;
            padding: 20px;
            border-radius: 8px;
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #FF9900;
        }
        
        .test-header h1 {
            color: #FF9900;
            font-size: 24px;
            margin: 0;
        }
        
        .test-scenario {
            background-color: #2A2B30;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #FF9900;
        }
        
        .test-scenario h3 {
            color: #FF9900;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .test-step {
            background-color: #3A3B40;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 3px solid #6c757d;
        }
        
        .test-step.passed {
            border-left-color: #28a745;
            background-color: #1e3a1e;
        }
        
        .test-step.failed {
            border-left-color: #dc3545;
            background-color: #3a1e1e;
        }
        
        .test-step.running {
            border-left-color: #ffc107;
            background-color: #3a3a1e;
        }
        
        .step-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .step-result {
            font-size: 14px;
            margin-top: 5px;
        }
        
        .step-result.success {
            color: #28a745;
        }
        
        .step-result.error {
            color: #dc3545;
        }
        
        .step-result.info {
            color: #17a2b8;
        }
        
        button {
            background-color: #FF9900;
            color: #0F1014;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #e68900;
        }
        
        .run-scenario-btn {
            background-color: #28a745;
            font-size: 16px;
            padding: 12px 25px;
        }
        
        .run-scenario-btn:hover {
            background-color: #218838;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background-color: #2A2B30;
            border-radius: 8px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 20px;
            font-weight: bold;
            color: #FF9900;
        }
        
        .stat-label {
            font-size: 12px;
            color: #ADADAD;
        }
        
        .test-data {
            background-color: #1A1B20;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        
        .scenario-description {
            background-color: #1A1B20;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            border: 1px solid #FF9900;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h1>
            <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</p>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="total-scenarios">0</div>
                <div class="stat-label">–°—Ü–µ–Ω–∞—Ä–∏–µ–≤</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="passed-scenarios">0</div>
                <div class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="failed-scenarios">0</div>
                <div class="stat-label">–ü—Ä–æ–≤–∞–ª–µ–Ω–æ</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="scenario-success-rate">0%</div>
                <div class="stat-label">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å</div>
            </div>
        </div>
        
        <div style="text-align: center; margin: 20px 0;">
            <button class="run-scenario-btn" onclick="runAllScenarios()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</button>
            <button onclick="clearScenarioResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
        </div>
        
        <div id="scenario-results"></div>
    </div>

    <script>
        let scenarioResults = {
            total: 0,
            passed: 0,
            failed: 0
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–≥–∞ —Ç–µ—Å—Ç–∞
        function createTestStep(title, stepFunction) {
            const stepDiv = document.createElement('div');
            stepDiv.className = 'test-step';
            stepDiv.innerHTML = `
                <div class="step-title">${title}</div>
                <div class="step-result" id="step-result-${Date.now()}-${Math.random()}">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
            `;
            
            const resultDiv = stepDiv.querySelector('.step-result');
            
            return {
                element: stepDiv,
                resultDiv: resultDiv,
                run: async () => {
                    stepDiv.className = 'test-step running';
                    resultDiv.textContent = '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...';
                    
                    try {
                        const result = await stepFunction();
                        if (result.success) {
                            stepDiv.className = 'test-step passed';
                            resultDiv.className = 'step-result success';
                            resultDiv.textContent = result.message;
                        } else {
                            stepDiv.className = 'test-step failed';
                            resultDiv.className = 'step-result error';
                            resultDiv.textContent = result.message;
                        }
                        return result.success;
                    } catch (error) {
                        stepDiv.className = 'test-step failed';
                        resultDiv.className = 'step-result error';
                        resultDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                        return false;
                    }
                }
            };
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        function updateScenarioStats() {
            document.getElementById('total-scenarios').textContent = scenarioResults.total;
            document.getElementById('passed-scenarios').textContent = scenarioResults.passed;
            document.getElementById('failed-scenarios').textContent = scenarioResults.failed;
            
            const successRate = scenarioResults.total > 0 ? 
                Math.round((scenarioResults.passed / scenarioResults.total) * 100) : 0;
            document.getElementById('scenario-success-rate').textContent = successRate + '%';
        }

        // –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        function createScenario1() {
            const container = document.createElement('div');
            container.className = 'test-scenario';
            container.innerHTML = `
                <h3>üìù –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞</h3>
                <div class="scenario-description">
                    <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage.
                </div>
            `;
            
            const steps = [
                createTestStep('1. –û—Ç–∫—Ä—ã—Ç–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    if (adminWindow && adminWindow.document.querySelector('#product-form')) {
                        return { success: true, message: '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞' };
                    }
                    return { success: false, message: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å' };
                }),
                
                createTestStep('2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const titleInput = form.querySelector('#title');
                    const authorInput = form.querySelector('#author_id');
                    const descInput = form.querySelector('#description');
                    const priceInput = form.querySelector('#price');
                    
                    titleInput.value = '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç';
                    authorInput.value = '999';
                    descInput.value = '–¢–æ–≤–∞—Ä –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è';
                    priceInput.value = '199.99';
                    
                    if (titleInput.value === '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç') {
                        return { success: true, message: '–§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞' };
                    }
                    return { success: false, message: '–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã' };
                }),
                
                createTestStep('3. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const submitBtn = form.querySelector('button[type="submit"]');
                    
                    submitBtn.click();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    return { success: true, message: '–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞' };
                }),
                
                createTestStep('4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const tbody = adminWindow.document.querySelector('#products-table tbody');
                    const rows = tbody.querySelectorAll('tr');
                    
                    let found = false;
                    for (let row of rows) {
                        const cells = row.querySelectorAll('td');
                        if (cells.length > 0 && cells[1].textContent.includes('–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç')) {
                            found = true;
                            break;
                        }
                    }
                    
                    if (found) {
                        return { success: true, message: '–¢–æ–≤–∞—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ' };
                    }
                    return { success: false, message: '–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ' };
                }),
                
                createTestStep('5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage', async () => {
                    const savedData = localStorage.getItem('admin_products');
                    if (savedData) {
                        const products = JSON.parse(savedData);
                        const testProduct = products.find(p => p.title === '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç');
                        
                        if (testProduct) {
                            return { success: true, message: '–¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage' };
                        }
                    }
                    return { success: false, message: '–¢–æ–≤–∞—Ä –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage' };
                })
            ];
            
            steps.forEach(step => {
                container.appendChild(step.element);
            });
            
            return {
                container: container,
                steps: steps,
                run: async () => {
                    let allPassed = true;
                    for (let step of steps) {
                        const passed = await step.run();
                        if (!passed) allPassed = false;
                        await new Promise(resolve => setTimeout(resolve, 200));
                    }
                    
                    if (allPassed) {
                        scenarioResults.passed++;
                    } else {
                        scenarioResults.failed++;
                    }
                    scenarioResults.total++;
                    updateScenarioStats();
                }
            };
        }

        // –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
        function createScenario2() {
            const container = document.createElement('div');
            container.className = 'test-scenario';
            container.innerHTML = `
                <h3>‚úèÔ∏è –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                <div class="scenario-description">
                    <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–æ–≤–∞—Ä, –∏–∑–º–µ–Ω—è–µ—Ç –µ–≥–æ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
                </div>
            `;
            
            const steps = [
                createTestStep('1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö', async () => {
                    const testData = [
                        { id: 1, title: "–¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–∏–≥–∞", author_id: 1, description: "–û–ø–∏—Å–∞–Ω–∏–µ", price: 100 }
                    ];
                    localStorage.setItem('admin_products', JSON.stringify(testData));
                    return { success: true, message: '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã' };
                }),
                
                createTestStep('2. –û—Ç–∫—Ä—ã—Ç–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    if (adminWindow && adminWindow.document.querySelector('#products-table')) {
                        return { success: true, message: '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞' };
                    }
                    return { success: false, message: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å' };
                }),
                
                createTestStep('3. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const editBtn = adminWindow.document.querySelector('.edit-btn');
                    if (editBtn) {
                        editBtn.click();
                        await new Promise(resolve => setTimeout(resolve, 500));
                        return { success: true, message: '–ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∞' };
                    }
                    return { success: false, message: '–ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞' };
                }),
                
                createTestStep('4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const editBtn = adminWindow.document.querySelector('.edit-btn');
                    editBtn.click();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const titleInput = form.querySelector('#title');
                    
                    if (titleInput.value === '–¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–∏–≥–∞') {
                        return { success: true, message: '–§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞' };
                    }
                    return { success: false, message: '–§–æ—Ä–º–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞' };
                }),
                
                createTestStep('5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const editBtn = adminWindow.document.querySelector('.edit-btn');
                    editBtn.click();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const titleInput = form.querySelector('#title');
                    const priceInput = form.querySelector('#price');
                    
                    titleInput.value = '–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞';
                    priceInput.value = '150';
                    
                    if (titleInput.value === '–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞' && priceInput.value === '150') {
                        return { success: true, message: '–î–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω—ã' };
                    }
                    return { success: false, message: '–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö' };
                }),
                
                createTestStep('6. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const editBtn = adminWindow.document.querySelector('.edit-btn');
                    editBtn.click();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const titleInput = form.querySelector('#title');
                    const priceInput = form.querySelector('#price');
                    
                    titleInput.value = '–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞';
                    priceInput.value = '150';
                    
                    const submitBtn = form.querySelector('button[type="submit"]');
                    submitBtn.click();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    return { success: true, message: '–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã' };
                }),
                
                createTestStep('7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const tbody = adminWindow.document.querySelector('#products-table tbody');
                    const rows = tbody.querySelectorAll('tr');
                    
                    let found = false;
                    for (let row of rows) {
                        const cells = row.querySelectorAll('td');
                        if (cells.length > 0 && cells[1].textContent === '–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞') {
                            found = true;
                            break;
                        }
                    }
                    
                    if (found) {
                        return { success: true, message: '–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ' };
                    }
                    return { success: false, message: '–¢–æ–≤–∞—Ä –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ' };
                })
            ];
            
            steps.forEach(step => {
                container.appendChild(step.element);
            });
            
            return {
                container: container,
                steps: steps,
                run: async () => {
                    let allPassed = true;
                    for (let step of steps) {
                        const passed = await step.run();
                        if (!passed) allPassed = false;
                        await new Promise(resolve => setTimeout(resolve, 200));
                    }
                    
                    if (allPassed) {
                        scenarioResults.passed++;
                    } else {
                        scenarioResults.failed++;
                    }
                    scenarioResults.total++;
                    updateScenarioStats();
                }
            };
        }

        // –°—Ü–µ–Ω–∞—Ä–∏–π 3: –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
        function createScenario3() {
            const container = document.createElement('div');
            container.className = 'test-scenario';
            container.innerHTML = `
                <h3>üóëÔ∏è –°—Ü–µ–Ω–∞—Ä–∏–π 3: –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                <div class="scenario-description">
                    <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç —Ç–æ–≤–∞—Ä –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ.
                </div>
            `;
            
            const steps = [
                createTestStep('1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö', async () => {
                    const testData = [
                        { id: 1, title: "–ö–Ω–∏–≥–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è", author_id: 1, description: "–û–ø–∏—Å–∞–Ω–∏–µ", price: 100 },
                        { id: 2, title: "–î—Ä—É–≥–∞—è –∫–Ω–∏–≥–∞", author_id: 2, description: "–û–ø–∏—Å–∞–Ω–∏–µ", price: 200 }
                    ];
                    localStorage.setItem('admin_products', JSON.stringify(testData));
                    return { success: true, message: '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã' };
                }),
                
                createTestStep('2. –û—Ç–∫—Ä—ã—Ç–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    if (adminWindow && adminWindow.document.querySelector('#products-table')) {
                        return { success: true, message: '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞' };
                    }
                    return { success: false, message: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å' };
                }),
                
                createTestStep('3. –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–æ —É–¥–∞–ª–µ–Ω–∏—è', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const tbody = adminWindow.document.querySelector('#products-table tbody');
                    const initialRows = tbody.querySelectorAll('tr').length;
                    
                    if (initialRows >= 2) {
                        return { success: true, message: `–ù–∞–π–¥–µ–Ω–æ ${initialRows} —Ç–æ–≤–∞—Ä–æ–≤` };
                    }
                    return { success: false, message: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞' };
                }),
                
                createTestStep('4. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–£–¥–∞–ª–∏—Ç—å"', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const deleteBtn = adminWindow.document.querySelector('.delete-btn');
                    if (deleteBtn) {
                        // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                        adminWindow.confirm = () => true;
                        deleteBtn.click();
                        await new Promise(resolve => setTimeout(resolve, 500));
                        return { success: true, message: '–ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∞' };
                    }
                    return { success: false, message: '–ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞' };
                }),
                
                createTestStep('5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const tbody = adminWindow.document.querySelector('#products-table tbody');
                    const finalRows = tbody.querySelectorAll('tr').length;
                    
                    if (finalRows < 2) {
                        return { success: true, message: `–û—Å—Ç–∞–ª–æ—Å—å ${finalRows} —Ç–æ–≤–∞—Ä–æ–≤` };
                    }
                    return { success: false, message: '–¢–æ–≤–∞—Ä –Ω–µ –±—ã–ª —É–¥–∞–ª–µ–Ω' };
                }),
                
                createTestStep('6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è localStorage', async () => {
                    const savedData = localStorage.getItem('admin_products');
                    if (savedData) {
                        const products = JSON.parse(savedData);
                        const deletedProduct = products.find(p => p.title === '–ö–Ω–∏–≥–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
                        
                        if (!deletedProduct) {
                            return { success: true, message: '–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ localStorage' };
                        }
                    }
                    return { success: false, message: '–¢–æ–≤–∞—Ä –Ω–µ —É–¥–∞–ª–µ–Ω –∏–∑ localStorage' };
                })
            ];
            
            steps.forEach(step => {
                container.appendChild(step.element);
            });
            
            return {
                container: container,
                steps: steps,
                run: async () => {
                    let allPassed = true;
                    for (let step of steps) {
                        const passed = await step.run();
                        if (!passed) allPassed = false;
                        await new Promise(resolve => setTimeout(resolve, 200));
                    }
                    
                    if (allPassed) {
                        scenarioResults.passed++;
                    } else {
                        scenarioResults.failed++;
                    }
                    scenarioResults.total++;
                    updateScenarioStats();
                }
            };
        }

        // –°—Ü–µ–Ω–∞—Ä–∏–π 4: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        function createScenario4() {
            const container = document.createElement('div');
            container.className = 'test-scenario';
            container.innerHTML = `
                <h3>‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–π 4: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã</h3>
                <div class="scenario-description">
                    <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
                </div>
            `;
            
            const steps = [
                createTestStep('1. –û—Ç–∫—Ä—ã—Ç–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    if (adminWindow && adminWindow.document.querySelector('#product-form')) {
                        return { success: true, message: '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞' };
                    }
                    return { success: false, message: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å' };
                }),
                
                createTestStep('2. –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º—ã', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const submitBtn = form.querySelector('button[type="submit"]');
                    
                    submitBtn.click();
                    
                    const titleInput = form.querySelector('#title');
                    if (titleInput.checkValidity() === false) {
                        return { success: true, message: '–ü—É—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞' };
                    }
                    return { success: false, message: '–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç' };
                }),
                
                createTestStep('3. –¢–µ—Å—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π —Ü–µ–Ω—ã', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const priceInput = form.querySelector('#price');
                    
                    priceInput.value = -10;
                    
                    if (priceInput.checkValidity() === false) {
                        return { success: true, message: '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞' };
                    }
                    return { success: false, message: '–í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π —Ü–µ–Ω—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç' };
                }),
                
                createTestStep('4. –¢–µ—Å—Ç –Ω—É–ª–µ–≤–æ–≥–æ ID –∞–≤—Ç–æ—Ä–∞', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const authorInput = form.querySelector('#author_id');
                    
                    authorInput.value = 0;
                    
                    if (authorInput.checkValidity() === false) {
                        return { success: true, message: '–ù—É–ª–µ–≤–æ–π ID –∞–≤—Ç–æ—Ä–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω' };
                    }
                    return { success: false, message: '–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω—É–ª–µ–≤–æ–≥–æ ID –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç' };
                }),
                
                createTestStep('5. –¢–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö', async () => {
                    const adminWindow = window.open('admin.html', '_blank');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const form = adminWindow.document.getElementById('product-form');
                    const titleInput = form.querySelector('#title');
                    const authorInput = form.querySelector('#author_id');
                    const descInput = form.querySelector('#description');
                    const priceInput = form.querySelector('#price');
                    
                    titleInput.value = '–í–∞–ª–∏–¥–Ω–∞—è –∫–Ω–∏–≥–∞';
                    authorInput.value = 1;
                    descInput.value = '–í–∞–ª–∏–¥–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ';
                    priceInput.value = 100;
                    
                    if (titleInput.checkValidity() && authorInput.checkValidity() && 
                        descInput.checkValidity() && priceInput.checkValidity()) {
                        return { success: true, message: '–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω—è—Ç—ã' };
                    }
                    return { success: false, message: '–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç' };
                })
            ];
            
            steps.forEach(step => {
                container.appendChild(step.element);
            });
            
            return {
                container: container,
                steps: steps,
                run: async () => {
                    let allPassed = true;
                    for (let step of steps) {
                        const passed = await step.run();
                        if (!passed) allPassed = false;
                        await new Promise(resolve => setTimeout(resolve, 200));
                    }
                    
                    if (allPassed) {
                        scenarioResults.passed++;
                    } else {
                        scenarioResults.failed++;
                    }
                    scenarioResults.total++;
                    updateScenarioStats();
                }
            };
        }

        // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        async function runAllScenarios() {
            scenarioResults = { total: 0, passed: 0, failed: 0 };
            
            const resultsContainer = document.getElementById('scenario-results');
            resultsContainer.innerHTML = '';
            
            const scenarios = [
                createScenario1(),
                createScenario2(),
                createScenario3(),
                createScenario4()
            ];
            
            for (let scenario of scenarios) {
                resultsContainer.appendChild(scenario.container);
                await scenario.run();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        function clearScenarioResults() {
            document.getElementById('scenario-results').innerHTML = '';
            scenarioResults = { total: 0, passed: 0, failed: 0 };
            updateScenarioStats();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateScenarioStats();
        });
    </script>
</body>
</html>
