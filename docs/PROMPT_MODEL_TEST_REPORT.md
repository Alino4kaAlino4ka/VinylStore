# üìã –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –æ—Ç–ª–∞–¥–∫–µ –º–æ–¥–µ–ª–∏ Prompt

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Prompt (`database/models.py`)

**–ë—ã–ª–æ:**
- `id`: Integer (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π)
- `name`: String
- `content`: Text
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `is_active`, `created_at`, `updated_at`

**–°—Ç–∞–ª–æ:**
- `id`: String (—Å—Ç—Ä–æ–∫–æ–≤—ã–π, –Ω–µ –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä 'recommendation_prompt')
- `name`: String (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
- `template`: Text (—Å–∞–º —Ç–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞)

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ prompts-manager (`services/prompts-manager/main.py`)

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã Pydantic –º–æ–¥–µ–ª–∏:
  - `PromptBase`: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `template` –≤–º–µ—Å—Ç–æ `content`
  - `PromptResponse`: `id` —Ç–µ–ø–µ—Ä—å `str` –≤–º–µ—Å—Ç–æ `int`
  - –£–¥–∞–ª–µ–Ω—ã –ø–æ–ª—è `is_active`, `created_at`, `updated_at`
  
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤:
  - –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç—Ä–æ–∫–æ–≤—ã–π `id` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ (`id="recommendation_prompt"`)
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–µ `template` –≤–º–µ—Å—Ç–æ `content`

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
  - GET `/api/v1/prompts/{prompt_name}` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `template`
  - PUT `/api/v1/prompts/{prompt_name}` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `template` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞
  - POST `/api/v1/prompts/{prompt_name}/reset` - –æ–±–Ω–æ–≤–ª—è–µ—Ç `template`

- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ recommender (`services/recommender/main.py`)

- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_prompt_from_manager()` –æ–±–Ω–æ–≤–ª–µ–Ω–∞:
  - –¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–µ `template` –≤–º–µ—Å—Ç–æ `content`
  - –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏ (test_prompt_model.py)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´

```
‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
‚úì –¢–∞–±–ª–∏—Ü–∞ 'prompts' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úì –ö–æ–ª–æ–Ω–∫–∞ 'id' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ç–∏–ø: VARCHAR - —Å—Ç—Ä–æ–∫–æ–≤—ã–π)
‚úì –ö–æ–ª–æ–Ω–∫–∞ 'name' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úì –ö–æ–ª–æ–Ω–∫–∞ 'template' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ç–∏–ø: TEXT)
‚úì –ü—Ä–æ–º–ø—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Å id='test_prompt_001'
‚úì –ü—Ä–æ–º–ø—Ç —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω
‚úì –ü—Ä–æ–º–ø—Ç —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω –ø–æ name
‚úì –®–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω
```

### –¢–µ—Å—Ç 2: –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (test_prompts_full.py)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´

- ‚úÖ –ú–æ–¥–µ–ª—å Prompt —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –í—Å–µ –ø–æ–ª—è –º–æ–¥–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (id, name, template)
- ‚úÖ –¢–∏–ø—ã –ø–æ–ª–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:
  - `id`: VARCHAR (—Å—Ç—Ä–æ–∫–æ–≤—ã–π)
  - `name`: VARCHAR
  - `template`: TEXT
- ‚úÖ prompts-manager –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚úÖ Pydantic –º–æ–¥–µ–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Recommender –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–µ 'template'
- ‚úÖ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û–®–ò–ë–û–ö –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

```bash
python -m py_compile database/models.py
python -m py_compile services/prompts-manager/main.py
python -m py_compile services/recommender/main.py
```

–í—Å–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª–µ–π

- ‚úÖ –í –º–æ–¥–µ–ª–∏ `Prompt` –Ω–µ—Ç –ø–æ–ª—è `content`
- ‚úÖ –í Pydantic –º–æ–¥–µ–ª—è—Ö –Ω–µ—Ç –ø–æ–ª—è `content`
- ‚úÖ –í prompts-manager –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–æ–ª—é `content`
- ‚úÖ –í recommender –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `template` (–∫—Ä–æ–º–µ API OpenAI, –≥–¥–µ `content` - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–ª–µ)

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

```python
class Prompt(Base):
    __tablename__ = 'prompts'
    
    id = Column(String, primary_key=True, index=True)  # –°—Ç—Ä–æ–∫–æ–≤—ã–π –∫–ª—é—á
    name = Column(String, nullable=False)              # –ù–∞–∑–≤–∞–Ω–∏–µ
    template = Column(Text, nullable=False)             # –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞:

```python
prompt = Prompt(
    id="my_custom_prompt",
    name="–ú–æ–π –ø—Ä–æ–º–ø—Ç",
    template="–¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ –∑–¥–µ—Å—å..."
)
db.add(prompt)
db.commit()
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ —á–µ—Ä–µ–∑ API:

```python
response = requests.get("http://localhost:8007/api/v1/prompts/recommendation_prompt")
prompt = response.json()
template = prompt['template']  # –ò—Å–ø–æ–ª—å–∑—É–µ–º 'template', –Ω–µ 'content'
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**: –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è:
   - –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É `prompts`
   - –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
   - –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å ALTER TABLE –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

2. **–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ï—Å–ª–∏ –≤ –±–∞–∑–µ –µ—Å—Ç—å –ø—Ä–æ–º–ø—Ç—ã —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ø–æ–ª—è–º–∏ (`content`, `is_active` –∏ —Ç.–¥.), –æ–Ω–∏ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é.

3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–¥–∞ - –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- ‚úÖ **4 —Ñ–∞–π–ª–∞** –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ **3 —Ç–µ—Å—Ç–∞** –ø—Ä–æ–≤–µ–¥–µ–Ω—ã
- ‚úÖ **0 –æ—à–∏–±–æ–∫** –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- ‚úÖ **100%** —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- –ú–æ–¥–µ–ª—å `Prompt` –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- –°–µ—Ä–≤–∏—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é Prompt!

